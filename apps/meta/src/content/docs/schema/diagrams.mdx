---
title: Schema Diagrams
description: Visual documentation of the data schema - entity types, relationships, and data flow
sidebar:
  order: 1
---

import { Mermaid } from '@cairn/ui/mermaid';

Visual documentation of the CAIRN data schema. Source: `apps/longterm/src/data/schema.ts`.

## Entity Types

All entity types grouped by category:

<Mermaid client:load chart={`
flowchart TD
    subgraph CoreContent["Core Content"]
        direction TB
        risk["risk"]
        risk_factor["risk-factor"]
        capability["capability"]
        concept["concept / concepts"]
        crux["crux"]
        argument["argument"]
        case_study["case-study"]
    end

    subgraph SafetyResponses["Safety & Responses"]
        direction TB
        safety_agenda["safety-agenda"]
        safety_approaches["safety-approaches"]
        intervention["intervention"]
        policy["policy / policies"]
    end

    subgraph Organizations["Organizations"]
        direction TB
        organization["organization"]
        lab["lab"]
        lab_frontier["lab-frontier"]
        lab_research["lab-research"]
        lab_startup["lab-startup"]
        lab_academic["lab-academic"]
        funder["funder"]
    end

    subgraph Analysis["Analysis"]
        direction TB
        model["model / models"]
        scenario["scenario"]
        parameter["parameter"]
        metric["metric"]
        analysis["analysis"]
    end

    subgraph AITransitionModel["AI Transition Model"]
        direction TB
        atm_factor["ai-transition-model-factor"]
        atm_subitem["ai-transition-model-subitem"]
        atm_param["ai-transition-model-parameter"]
        atm_metric["ai-transition-model-metric"]
        atm_scenario["ai-transition-model-scenario"]
    end

    subgraph Other["Other"]
        direction TB
        researcher["researcher"]
        resource["resource"]
        historical["historical"]
        events["events"]
    end
`} />

## Relationship Types

How entities can relate to each other:

<Mermaid client:load chart={`
flowchart LR
    subgraph Causal["Causal"]
        causes["causes / cause"]
        drives["drives / driver / driven-by"]
        affects["affects"]
        amplifies["amplifies"]
        leads_to["leads-to"]
        contributes["contributes-to"]
        shaped["shaped-by"]
    end

    subgraph Mitigation["Mitigation"]
        mitigates["mitigates / mitigated-by"]
        mitigation["mitigation"]
        blocks["blocks"]
        addresses["addresses"]
    end

    subgraph Structural["Structural"]
        requires["requires"]
        enables["enables"]
        child_of["child-of"]
        composed_of["composed-of"]
        component["component"]
        prerequisite["prerequisite"]
    end

    subgraph Measurement["Measurement"]
        measures["measures / measured-by"]
        analyzes["analyzes / analyzed-by"]
        models["models"]
        increases["increases"]
        decreases["decreases"]
        supports["supports"]
    end

    subgraph Classification["Classification"]
        related["related"]
        example["example"]
        mechanism["mechanism"]
        outcome["outcome"]
        consequence["consequence"]
        manifestation["manifestation"]
        key_factor["key-factor"]
        scenario_rel["scenario / sub-scenario"]
        supersedes["supersedes"]
    end
`} />

## Schema Structure

ER diagram showing main types and their relationships:

<Mermaid client:load chart={`
erDiagram
    Entity {
        string id PK
        enum type
        string title
        string description
        enum severity
        string likelihood
        array tags
        array related
    }

    Resource {
        string id PK
        string url
        string title
        enum type
        string summary
        array authors
        string year
    }

    Publication {
        string id PK
        string name
        enum type
        int credibility
    }

    CauseEffectGraph {
        string title
        string description
        string primaryNodeId
        array nodes
        array edges
    }

    RelatedEntry {
        string id FK
        enum type
        enum relationship
    }

    Entity ||--o{ RelatedEntry : has
    Entity ||--o| CauseEffectGraph : has
    Entity }o--o{ Resource : references
    Resource }o--|| Publication : published_in
`} />

## Data Flow

How data flows from YAML files through validation to the UI:

<Mermaid client:load chart={`
flowchart TD
    subgraph Sources["YAML Data Sources"]
        E1[entities/*.yaml]
        E2[resources/*.yaml]
        E3[publications.yaml]
        E4[graphs/*.yaml]
    end

    subgraph Schema["Zod Schema Validation"]
        S1[Entity Schema]
        S2[Resource Schema]
        S3[Publication Schema]
        S4[CauseEffectGraph Schema]
    end

    subgraph Build["Build Pipeline"]
        B1[build-data.mjs]
        B2[database.json]
        B3[pathRegistry.json]
        B4[backlinks.json]
    end

    subgraph Validation["Validation Suite"]
        V1[validate-yaml-schema.mjs]
        V2[validate-data.mjs]
        V3[validate-graph-sync.mjs]
    end

    subgraph UI["UI Components"]
        U1[DataInfoBox]
        U2[ResourceCard]
        U3[CauseEffectGraph]
        U4[EntityLink]
    end

    E1 --> V1
    E2 --> V1
    E3 --> V1
    E4 --> V3

    V1 --> S1
    V1 --> S2
    V1 --> S3
    V3 --> S4

    E1 --> B1
    E2 --> B1
    E3 --> B1
    E4 --> B1

    B1 --> B2
    B1 --> B3
    B1 --> B4
    B2 --> U1
    B2 --> U2
    B2 --> U3
    B3 --> U4
`} />

## Statistics

| Metric | Count |
|--------|-------|
| Entity Types | 27 |
| Relationship Types | 47 |
| AI Transition Model Types | 5 |

## Key Schema Files

| File | Purpose |
|------|---------|
| `src/data/schema.ts` | Zod schemas and TypeScript types |
| `src/data/entities/*.yaml` | Entity definitions |
| `src/data/resources/*.yaml` | External resource references |
| `src/data/graphs/*.yaml` | Cause-effect graph definitions |

## Cause-Effect Graph Schema

Graphs are defined with nodes and edges:

```yaml
causeEffectGraph:
  title: "What Drives X?"
  description: "Causal factors affecting X"
  primaryNodeId: main-node
  nodes:
    - id: node-1
      label: "Node Label"
      type: leaf | cause | intermediate | effect
      description: "Node description"
      entityRef: optional-entity-id  # Links to entity page
      score: 75  # 0-100 importance score
  edges:
    - source: node-1
      target: node-2
      strength: strong | medium | weak
      effect: increases | decreases | mixed
```

### Node Types

| Type | Purpose | Visual |
|------|---------|--------|
| `leaf` | Root inputs, external factors | Teal |
| `cause` | Derived causal factors | Light gray |
| `intermediate` | Middle-tier factors | Darker gray |
| `effect` | Target outcomes | Amber |

### Edge Properties

| Property | Values | Meaning |
|----------|--------|---------|
| `strength` | strong, medium, weak | Line thickness |
| `effect` | increases, decreases, mixed | Arrow color/style |
