---
/**
 * Custom Head that includes dev mode initialization script
 */
const { head } = Astro.locals.starlightRoute;
---

{head.map(({ tag: Tag, attrs, content }) => <Tag {...attrs} set:html={content} />)}

<!-- KaTeX CSS for math rendering -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">

<!-- Initialize dev mode before page renders to prevent flash -->
<script is:inline>
  (function() {
    if (localStorage.getItem('pageStatusDevMode') === 'true') {
      document.documentElement.classList.add('page-status-dev-mode');
    }
  })();
</script>

<!-- Auto-expand sidebar to show current page on direct URL navigation -->
<script is:inline>
  function expandSidebarToCurrentPage() {
    const currentLink = document.querySelector('nav.sidebar a[aria-current="page"]');
    if (currentLink) {
      let parent = currentLink.parentElement;
      while (parent) {
        if (parent.tagName === 'DETAILS') {
          parent.open = true;
        }
        parent = parent.parentElement;
      }
    }
  }
  // Run when DOM is ready, or immediately if already loaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', expandSidebarToCurrentPage);
  } else {
    expandSidebarToCurrentPage();
  }
</script>
